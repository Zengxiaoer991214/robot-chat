# 1.1 ğŸ” ç”¨æˆ·é‰´æƒç³»ç»Ÿ (Authentication) å®æ–½è®¡åˆ’ (PostgreSQL ç‰ˆ)

## 1. æ•°æ®åº“ç­–ç•¥ (Database Strategy)
- **æ³¨æ„**: ç”±äºéœ€è¦å‘ç°æœ‰è¡¨ (`agents`, `roles`) æ·»åŠ **å¿…å¡«**çš„å¤–é”®å…³è” (`user_id`)ï¼Œä¸” `User` è¡¨ç»“æ„å‘ç”Ÿé‡å¤§å˜åŒ–ã€‚
- **æ–¹æ¡ˆ**: **æ¸…ç©ºå¹¶é‡å»ºæ•°æ®åº“**ã€‚è¿™å°†åˆ é™¤æ‰€æœ‰ç°æœ‰æ•°æ®ã€‚
- **åŸå› **: ä¿è¯æ•°æ®å®Œæ•´æ€§ï¼Œé¿å…å¤æ‚çš„è¿ç§»è„šæœ¬ï¼ˆç°æœ‰æ•°æ®æ²¡æœ‰æ‰€å±ç”¨æˆ·ï¼Œæ— æ³•ç›´æ¥æ·»åŠ éç©ºå¤–é”®ï¼‰ã€‚

## 2. åç«¯æ ¸å¿ƒå¼€å‘ (Backend)
### 2.1 ä¾èµ–å®‰è£…
- æ·»åŠ : `passlib[bcrypt]`, `python-jose[cryptography]`, `python-multipart`ã€‚

### 2.2 æ¨¡å‹é‡æ„ (Models)
- `User`: å¢åŠ  `hashed_password`, `email`, `is_active`ã€‚
- `Agent`: å¢åŠ  `user_id` (ForeignKey, nullable=False)ã€‚
- `Role`: å¢åŠ  `user_id` (ForeignKey, nullable=False)ã€‚
- `Room`: `creator_id` å·²å­˜åœ¨ï¼Œéœ€ç¡®ä¿å…³è”é€»è¾‘æ­£ç¡®ã€‚

### 2.3 è®¤è¯æ¨¡å— (Auth Module)
- `core/security.py`: å®ç°å¯†ç å“ˆå¸Œ (bcrypt) å’Œ JWT ç­¾å‘/æ ¡éªŒã€‚
- `api/deps.py`: å®ç° `get_current_user` ä¾èµ–ï¼Œè§£æ Token å¹¶æŸ¥è¯¢ DBã€‚
- `api/auth.py`:
  - `POST /auth/register`: æ³¨å†Œæ–°ç”¨æˆ·ã€‚
  - `POST /auth/token`: ç™»å½•å¹¶è·å– JWT (OAuth2PasswordRequestForm)ã€‚

### 2.4 ä¸šåŠ¡é€»è¾‘éš”ç¦» (Isolation)
- ä¿®æ”¹ `agents.py`, `roles.py`, `rooms.py`:
  - **Create**: `new_item.user_id = current_user.id`
  - **Read**: `query.filter(Model.user_id == current_user.id)`
  - **Update/Delete**: æ£€æŸ¥ `item.user_id == current_user.id`

## 3. å‰ç«¯åº”ç”¨å‡çº§ (Frontend)
### 3.1 çŠ¶æ€ä¸ç½‘ç»œ
- `services/api.ts`: æ·»åŠ  Axios æ‹¦æˆªå™¨ï¼Œè‡ªåŠ¨åœ¨ Header ä¸­é™„åŠ  `Authorization: Bearer <token>`ã€‚
- çŠ¶æ€ç®¡ç†: åœ¨ `localStorage` å­˜å‚¨ Tokenï¼Œå¹¶å¤„ç†è¿‡æœŸç™»å‡ºã€‚

### 3.2 ç•Œé¢å®ç°
- **Login.vue**: æ”¹é€ ä¸ºæ ‡å‡†ç™»å½•é¡µï¼ˆç”¨æˆ·å/å¯†ç ï¼‰ï¼Œå¯¹æ¥ `/auth/token`ã€‚
- **Register.vue**: æ–°å»ºæ³¨å†Œé¡µé¢ï¼Œå¯¹æ¥ `/auth/register`ã€‚
- **è·¯ç”±å®ˆå«**: æ›´æ–° `router/index.ts`ï¼Œæœªç™»å½•æ‹¦æˆªè·³è½¬è‡³ Loginã€‚

## 4. æ‰§è¡Œé¡ºåº
1.  å®‰è£…åç«¯ä¾èµ–ã€‚
2.  æ›´æ–°åç«¯æ¨¡å‹ (Models)ã€‚
3.  **é‡å»ºæ•°æ®åº“è¡¨** (Drop & Create)ã€‚
4.  å®ç°åç«¯ Auth/Security/Deps ä»£ç ã€‚
5.  æ›´æ–°åç«¯ä¸šåŠ¡ API (Agents/Roles/Rooms)ã€‚
6.  å®ç°å‰ç«¯ API æ‹¦æˆªå™¨ä¸æ³¨å†Œ/ç™»å½•é¡µé¢ã€‚
7.  è”è°ƒæµ‹è¯•ã€‚
